Options::jsonConfig            : /usr/local/etc/oai/hss_rel14.json
Options::diameterconfiguration : /usr/local/etc/oai/freeDiameter/hss_rel14_fd.conf
Options::cassserver            : 127.0.0.1
Options::cassuser              : root
Options::casspwd               : root
Options::cassdb                : vhss
Options::randvector            : 1
Options::roamallow             : 1
Options::optkey                : 1006020f0a478bf6b699f15c062e42b3
Options::reloadkey             : 0
Options::onlyloadkey           : 0
Options::gtwport               : 9080
Options::gtwhost               : *
Options::resthost              : 9081
Options::synchimsi             :
Options::synchauts             :
Initialized random
17:23:13  NOTI   libfdproto '1.2.1' initialized.
17:23:13  NOTI   libgnutls '3.5.18' initialized.
17:23:13  NOTI   HASHLIST is enabled
17:23:13  NOTI   libfdcore '1.2.1' initialized.
17:23:13  NOTI   Loading (acl_wl) extension.
17:23:13  NOTI   Extension ACL_wl initialized with configuration: '/usr/local/etc/oai/freeDiameter/acl.conf'
17:23:13  NOTI   Loading (dict_3gpp2_avps) extension.
17:23:13  NOTI   Loading (dict_draftload_avps) extension.
17:23:13  NOTI   Loading (dict_etsi283034_avps) extension.
17:23:13  NOTI   Loading (dict_rfc4004_avps) extension.
17:23:13  NOTI   Loading (dict_rfc4006bis_avps) extension.
17:23:13  NOTI   Loading (dict_rfc4072_avps) extension.
17:23:13  NOTI   Loading (dict_rfc4590_avps) extension.
17:23:13  NOTI   Loading (dict_rfc5447_avps) extension.
17:23:13  NOTI   Loading (dict_rfc5580_avps) extension.
17:23:13  NOTI   Loading (dict_rfc5777_avps) extension.
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: (INTEGER32   ) "IPTM" -> 84
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fafd0640): ENUMVAL p:0x55d5fafc7e40 data: (INTEGER32   ) "TTP" -> 84
17:23:13  NOTI   Loading (dict_rfc5778_avps) extension.
17:23:13  NOTI   Loading (dict_rfc6734_avps) extension.
17:23:13  NOTI   Loading (dict_rfc6942_avps) extension.
17:23:13  NOTI   Loading (dict_rfc7155_avps) extension.
17:23:13  NOTI   Loading (dict_rfc7683_avps) extension.
17:23:13  NOTI   Loading (dict_rfc7944_avps) extension.
17:23:13  NOTI   Loading (dict_ts29061_avps) extension.
17:23:13  NOTI   Loading (dict_ts29128_avps) extension.
17:23:13  NOTI   Loading (dict_ts29154_avps) extension.
17:23:13  NOTI   Loading (dict_ts29173_avps) extension.
17:23:13  NOTI   Loading (dict_ts29212_avps) extension.
17:23:13  NOTI   Loading (dict_ts29214_avps) extension.
17:23:13  NOTI   Loading (dict_ts29215_avps) extension.
17:23:13  NOTI   Loading (dict_ts29217_avps) extension.
17:23:13  NOTI   Loading (dict_ts29229_avps) extension.
17:23:13  NOTI   Loading (dict_ts29272_avps) extension.
17:23:13  NOTI   Loading (dict_ts29273_avps) extension.
17:23:13  NOTI   Loading (dict_ts29329_avps) extension.
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: v/m:VM/VM,  OCTETSTRING, 702    "User-Data"
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb059d00): AVP p:(nil) data: v/m:VM/VM,  OCTETSTRING, 606    "User-Data"
17:23:13  NOTI   Loading (dict_ts29336_avps) extension.
17:23:13  NOTI   Loading (dict_ts29337_avps) extension.
17:23:13  NOTI   Loading (dict_ts29338_avps) extension.
17:23:13  NOTI   Loading (dict_ts29343_avps) extension.
17:23:13  NOTI   Loading (dict_ts29344_avps) extension.
17:23:13  NOTI   Loading (dict_ts29345_avps) extension.
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: v/m:VM/VM,   UNSIGNED32, 3818   "Time-Window"
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb01eb60): AVP p:(nil) data: v/m:VM/VM,      GROUPED, 4204   "Time-Window"
17:23:13  NOTI   Loading (dict_ts29368_avps) extension.
17:23:13  NOTI   Loading (dict_ts29468_avps) extension.
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: v/m:V-/VM,  OCTETSTRING, 3522   "MBMS-GW-SSM-IP-Address"
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb0191d0): AVP p:(nil) data: v/m:V-/VM,  OCTETSTRING, 924    "MBMS-GW-SSM-IP-Address"
17:23:13  NOTI   Loading (dict_ts32299_avps) extension.
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: (INTEGER32   ) "Active" -> 0
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb020f80): ENUMVAL p:0x55d5fb020d20 data: (INTEGER32   ) "ACTIVE" -> 0
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: (INTEGER32   ) "Inactive" -> 1
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb021140): ENUMVAL p:0x55d5fb020d20 data: (INTEGER32   ) "INACTIVE" -> 1
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: v/m:VM/VM,    INTEGER32, 4406   "3GPP-PS-Data-Off-Status"
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb0212c0): AVP p:0x55d5fb020d20 data: v/m:V-/VM,    INTEGER32, 2847   "3GPP-PS-Data-Off-Status"
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: v/m:VM/VM,  OCTETSTRING, 3462   "Radio-Frequency"
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb0bbb80): AVP p:(nil) data: v/m:VM/VM,   UNSIGNED32, 3508   "Radio-Frequency"
17:23:13  NOTI   Loading (dict_s6as6d) extension.
17:23:13  NOTI   Loading (dict_s6t) extension.
17:23:13  NOTI   Loading (dict_s6c) extension.
17:23:13  NOTI   An error occurred while adding the following data in the dictionary: data: (UNSIGNED32  ) "Permanent_Failures" -> 3
17:23:13  NOTI   Conflicting entry in the dictionary: {dictobj}(@0x55d5fb1140f0): ENUMVAL p:0x55d5faf77db0 data: (UNSIGNED32  ) "MME_SGSN_behaviour" -> 3
17:23:13  NOTI   Unable to  resolve symbol 'fd_ext_init2' for extension /usr/local/lib/freeDiameter/acl_wl.fdx:
17:23:13  NOTI   All extensions loaded.
17:23:13  NOTI   freeDiameter configuration:
17:23:13  NOTI     Default trace level .... : +3
17:23:13  NOTI     Configuration file ..... : /usr/local/etc/oai/freeDiameter/hss_rel14_fd.conf
17:23:13  NOTI     Diameter Identity ...... : hss.openair4G.eur (l:17)
17:23:13  NOTI     Diameter Realm ......... : openair4G.eur (l:13)
17:23:13  NOTI     Tc Timer ............... : 30
17:23:13  NOTI     Tw Timer ............... : 30
17:23:13  NOTI     Local port ............. : 3868
17:23:13  NOTI     Local secure port ...... : 5868
17:23:13  NOTI     Number of SCTP streams . : 3
17:23:13  NOTI     Number of clients thr .. : 5
17:23:13  NOTI     Number of app threads .. : 4
17:23:13  NOTI     Local endpoints ........ : Default (use all available)
17:23:13  NOTI     Local applications ..... : (none)
17:23:13  NOTI     Flags : - IP ........... : Enabled
17:23:13  NOTI             - IPv6 ......... : DISABLED
17:23:13  NOTI             - Relay app .... : DISABLED
17:23:13  NOTI             - TCP .......... : Enabled
17:23:13  NOTI             - SCTP ......... : DISABLED (at compilation)
17:23:13  NOTI             - Pref. proto .. : TCP
17:23:13  NOTI             - TLS method ... : Separate port
17:23:13  NOTI     TLS :   - Certificate .. : /usr/local/etc/oai/freeDiameter/hss.cert.pem
17:23:13  NOTI             - Private key .. : /usr/local/etc/oai/freeDiameter/hss.key.pem
17:23:13  NOTI             - CA (trust) ... : /usr/local/etc/oai/freeDiameter/hss.cacert.pem (1 certs)
17:23:13  NOTI             - CRL .......... : (none)
17:23:13  NOTI             - Priority ..... : (default: 'NORMAL')
17:23:13  NOTI             - DH bits ...... : 1024
17:23:13  NOTI     Origin-State-Id ........ : 1625671393
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/acl_wl.fdx'[/usr/local/etc/oai/freeDiameter/acl.conf], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_3gpp2_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_draftload_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_etsi283034_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc4004_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc4006bis_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc4072_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc4590_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc5447_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc5580_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc5777_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc5778_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc6734_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc6942_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc7155_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc7683_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_rfc7944_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29061_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29128_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29154_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29173_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29212_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29214_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29215_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29217_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29229_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29272_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29273_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29329_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29336_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29337_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29338_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29343_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29344_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29345_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29368_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts29468_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_ts32299_avps.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_S6as6d.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_S6t.fdx'[(no config file)], loaded
17:23:13  NOTI   Loaded extensions: '/usr/local/lib/freeDiameter/dict_S6c.fdx'[(no config file)], loaded
Connecting to cassandra host: 127.0.0.1
Registering s6t dictionary
Registering s6t command handlers
Registering COIR command handler
Registering NIIR command handler
Registering s6as6d dictionary
Registering s6as6d command handlers
Registering UPLR command handler
Registering AUIR command handler
Registering PUUR command handler
Registering s6c dictionary
Registering s6c command handlers
Registering SERIFSR command handler
17:23:13  NOTI   Local server address(es): 12.1.1.1{---L-}      147.127.245.146{---L-}  172.16.1.102{---L-}     172.16.1.104{---L-}     172.55.55.101{---L-}    172.55.55.102{---L-}    172.58.58.101{---L-}    172.58.58.102{---L-}      192.168.0.2{---L-}      192.168.10.110{---L-}   192.168.247.102{---L-}  192.168.248.159{---L-}
The freeDiameter engine has been started
Started REST server on port [9081]
17:23:13  NOTI   Unable to resolve address for peer 'mme.localdomain' (Name or service not known), aborting
17:23:13  ERROR  mme.localdomain: Going to ZOMBIE state (no more activity)
17:23:13  NOTI   'STATE_CLOSED' -> 'STATE_ZOMBIE' (terminated)  'mme.localdomain'

Broadcast message from systemd-journald@overload (Wed 2021-07-07 17:23:26 CEST):

mme[6648]: 000000 00000:905851 7F43135BB2C0 DEBUG CONFIG nair-cn/src/mme_app/mme_config.c:1240    Config file is (null)


Broadcast message from systemd-journald@overload (Wed 2021-07-07 17:23:26 CEST):

mme[6648]: 000001 00000:906272 7F43135BB2C0 INFO  MME-AP nair-cn/src/mme_app/mme_config.c:0791    Parsing configuration file found S1-MME: 192.168.247.102/24 on enp5s0f3


Broadcast message from systemd-journald@overload (Wed 2021-07-07 17:23:26 CEST):

mme[6648]: 000002 00000:906298 7F43135BB2C0 INFO  MME-AP nair-cn/src/mme_app/mme_config.c:0807    Parsing configuration file found S11: 172.16.1.102/24 on enp5s0f1:m11


Broadcast message from systemd-journald@overload (Wed 2021-07-07 17:23:26 CEST):

mme[6648]: 000003 00000:906313 7F43135BB2C0 INFO  MME-AP nair-cn/src/mme_app/mme_config.c:0822    Parsing configuration file found S10: 192.168.10.110/24 on enp5s0f1:m10


Broadcast message from systemd-journald@overload (Wed 2021-07-07 17:23:26 CEST):

mme[6648]: 000004 00000:906342 7F43135BB2C0 INFO  MME-AP nair-cn/src/mme_app/mme_config.c:0962    Parsing configuration file found S-GW S11: 172.16.1.104

SELECT idmmeidentity FROM vhss.mmeidentity_host WHERE mmehost='mme.openair4G.eur';
Accepting mme.openair4G.eur peer
17:23:26  NOTI   Connected to 'mme.openair4G.eur' (TCP,soc#20), remote capabilities:
17:23:26  NOTI      Capabilities-Exchange-Request(257)[R---], Length=400, Hop-By-Hop-Id=0x349ebb8f, End-to-End=0x6ee97519, { Origin-Host(264)[-M]="mme.openair4G.eur" }, { Origin-Realm(296)[-M]="openair4G.eur" }, { Origin-State-Id(278)[-M]=1625671406 (0x60e5c6ee) }, { Host-IP-Address(257)[-M]=12.1.1.1 }, { Host-IP-Address(257)[-M]=147.127.245.146 }, { Host-IP-Address(257)[-M]=172.16.1.102 }, { Host-IP-Address(257)[-M]=172.16.1.104 }, { Host-IP-Address(257)[-M]=172.55.55.101 }, { Host-IP-Address(257)[-M]=172.55.55.102 }, { Host-IP-Address(257)[-M]=172.58.58.101 }, { Host-IP-Address(257)[-M]=172.58.58.102 }, { Host-IP-Address(257)[-M]=192.168.0.2 }, { Host-IP-Address(257)[-M]=192.168.10.110 }, { Host-IP-Address(257)[-M]=192.168.247.102 }, { Host-IP-Address(257)[-M]=192.168.248.159 }, { Vendor-Id(266)[-M]=0 (0x0) }, { Product-Name(269)[--]="freeDiameter" }, { Firmware-Revision(267)[--]=10201 (0x27d9) }, { Inband-Security-Id(299)[-M]='NO_INBAND_SECURITY' (0 (0x0)) }, { Vendor-Specific-Application-Id(260)[-M]={ Auth-Application-Id(258)[-M]=16777251 (0x1000023) }, { Vendor-Id(266)[-M]=10415 (0x28af) } }, { Supported-Vendor-Id(265)[-M]=5535 (0x159f) }, { Supported-Vendor-Id(265)[-M]=10415 (0x28af) }, { Supported-Vendor-Id(265)[-M]=13019 (0x32db) }
17:23:26  NOTI   No TLS protection negotiated with peer 'mme.openair4G.eur'.
17:23:26  NOTI   'STATE_CLOSED' -> 'STATE_OPEN' 'mme.openair4G.eur'
'Authentication-Information-Request'
  Version: 0x01
  Length: 268
  Flags: 0xC0 (RP--)
  Command Code: 318
  ApplicationId: 16777251
  Hop-by-Hop Identifier: 0x349EBB91
  End-to-End Identifier: 0x00000000
   {internal data}: src:mme.openair4G.eur(17) rwb:(nil) rt:1 cb:(nil),(nil)((nil)) qry:(nil) asso:0 sess:0x7f15b4000d70
   AVP: 'Session-Id'(263) l=45 f=-M val="mme.openair4G.eur;1625671406;1;apps6a"
   AVP: 'Auth-Session-State'(277) l=12 f=-M val='NO_STATE_MAINTAINED' (1 (0x1))
   AVP: 'Origin-Host'(264) l=25 f=-M val="mme.openair4G.eur"
   AVP: 'Origin-Realm'(296) l=21 f=-M val="openair4G.eur"
   AVP: 'Destination-Host'(293) l=25 f=-M val="hss.openair4G.eur"
   AVP: 'Destination-Realm'(283) l=21 f=-M val="openair4G.eur"
   AVP: 'User-Name'(1) l=23 f=-M val="208930000000007"
   AVP: 'Visited-PLMN-Id'(1407) vend='3GPP'(10415) l=15 f=VM val=<02 F8 39>
   AVP: 'Requested-EUTRAN-Authentication-Info'(1408) vend='3GPP'(10415) l=44 f=VM val=(grouped)
      AVP: 'Number-Of-Requested-Vectors'(1410) vend='3GPP'(10415) l=16 f=VM val=1 (0x1)
      AVP: 'Immediate-Response-Preferred'(1412) vend='3GPP'(10415) l=16 f=VM val=0 (0x0)
   AVP: 'Route-Record'(282) l=8 f=-M val="mme.openair4G.eur"
SELECT key,sqn,rand,OPc FROM vhss.users_imsi WHERE imsi='208930000000007';
Generated random
RijndaelKeySchedule: K FEC86BA6EB707ED08905757B1BB44B8F
MAC_A   : 7f.b6.65.36.f2.a9.e3.58.
SQN     : 00.00.00.00.02.20.
RAND    : 95.be.0a.13.c3.37.51.63.7c.2e.62.1b.3c.8c.97.3f.
RijndaelKeySchedule: K FEC86BA6EB707ED08905757B1BB44B8F
AK      : 2e.ce.41.57.97.95.
CK      : 04.2b.e4.c8.ec.d5.ff.0a.07.ff.d6.14.cd.41.cd.c4.
IK      : be.f9.03.87.af.7f.87.d7.28.15.4d.f7.07.64.a7.1e.
XRES    : 78.00.47.a9.1b.4b.a5.88.
AUTN    : 2e.ce.41.57.95.b5.80.00.7f.b6.65.36.f2.a9.e3.58.
0x04 0x2b 0xe4 0xc8 0xec 0xd5 0xff 0x0a 0x07 0xff 0xd6 0x14 0xcd 0x41 0xcd 0xc4 0xbe 0xf9 0x03 0x87 0xaf 0x7f 0x87 0xd7 0x28 0x15 0x4d 0xf7 0x07 0x64 0xa7 0x1e
0x10 0x02 0xf8 0x39 0x00 0x03 0x2e 0xce 0x41 0x57 0x95 0xb5 0x00 0x06
KASME   : db.57.a1.fb.38.4c.f2.7b.4f.5a.69.81.1e.d5.8e.95.5f.a6.b4.3a.58.24.91.dd.15.47.17.26.f3.14.27.fb.
sqn=00.00.00.00.02.20. eu.u8[]=20.02.00.00.00.00.00.00. eu.u64=544 rand=[95be0a13c33751637c2e621b3c8c973f]
UPDATE vhss.users_imsi SET rand='95be0a13c33751637c2e621b3c8c973f', sqn=544 WHERE imsi='208930000000007';
UPDATE vhss.users_imsi SET sqn =576 WHERE imsi='208930000000007';
'Authentication-Information-Answer'
  Version: 0x01
  Length: 20
  Flags: 0x40 (-P--)
  Command Code: 318
  ApplicationId: 16777251
  Hop-by-Hop Identifier: 0x349EBB91
  End-to-End Identifier: 0x00000000
   {internal data}: src:(nil)(0) rwb:(nil) rt:0 cb:(nil),(nil)((nil)) qry:0x7f15a0002bb0 asso:0 sess:0x7f15b4000d70
   AVP: 'Session-Id'(263) l=8 f=-M val="mme.openair4G.eur;1625671406;1;apps6a"
   AVP: 'Origin-Host'(264) l=8 f=-M val="hss.openair4G.eur"
   AVP: 'Origin-Realm'(296) l=8 f=-M val="openair4G.eur"
   AVP: 'Auth-Session-State'(277) l=12 f=-M val='NO_STATE_MAINTAINED' (1 (0x1))
   AVP: 'Authentication-Info'(1413) vend='3GPP'(10415) l=12 f=VM val=(grouped)
      AVP: 'E-UTRAN-Vector'(1414) vend='3GPP'(10415) l=12 f=VM val=(grouped)
         AVP: 'RAND'(1447) vend='3GPP'(10415) l=12 f=VM val=<95 BE 0A 13 C3 37 51 63 7C 2E 62 1B 3C 8C 97 3F>
         AVP: 'XRES'(1448) vend='3GPP'(10415) l=12 f=VM val=<78 00 47 A9 1B 4B A5 88>
         AVP: 'AUTN'(1449) vend='3GPP'(10415) l=12 f=VM val=<2E CE 41 57 95 B5 80 00 7F B6 65 36 F2 A9 E3 58>
         AVP: 'KASME'(1450) vend='3GPP'(10415) l=12 f=VM val=<DB 57 A1 FB 38 4C F2 7B 4F 5A 69 81 1E D5 8E 95 5F A6 B4 3A 58 24 91 DD 15 47 17 26 F3 14 27 FB>
   AVP: 'Result-Code'(268) l=12 f=-M val='DIAMETER_SUCCESS' (2001 (0x7d1))
'Authentication-Information-Request'
  Version: 0x01
  Length: 312
  Flags: 0xC0 (RP--)
  Command Code: 318
  ApplicationId: 16777251
  Hop-by-Hop Identifier: 0x349EBB92
  End-to-End Identifier: 0x00000000
   {internal data}: src:mme.openair4G.eur(17) rwb:(nil) rt:1 cb:(nil),(nil)((nil)) qry:(nil) asso:0 sess:0x7f15c0000e50
   AVP: 'Session-Id'(263) l=45 f=-M val="mme.openair4G.eur;1625671406;2;apps6a"
   AVP: 'Auth-Session-State'(277) l=12 f=-M val='NO_STATE_MAINTAINED' (1 (0x1))
   AVP: 'Origin-Host'(264) l=25 f=-M val="mme.openair4G.eur"
   AVP: 'Origin-Realm'(296) l=21 f=-M val="openair4G.eur"
   AVP: 'Destination-Host'(293) l=25 f=-M val="hss.openair4G.eur"
   AVP: 'Destination-Realm'(283) l=21 f=-M val="openair4G.eur"
   AVP: 'User-Name'(1) l=23 f=-M val="208930000000007"
   AVP: 'Visited-PLMN-Id'(1407) vend='3GPP'(10415) l=15 f=VM val=<02 F8 39>
   AVP: 'Requested-EUTRAN-Authentication-Info'(1408) vend='3GPP'(10415) l=88 f=VM val=(grouped)
      AVP: 'Number-Of-Requested-Vectors'(1410) vend='3GPP'(10415) l=16 f=VM val=1 (0x1)
      AVP: 'Immediate-Response-Preferred'(1412) vend='3GPP'(10415) l=16 f=VM val=0 (0x0)
      AVP: 'Re-Synchronization-Info'(1411) vend='3GPP'(10415) l=42 f=VM val=<95 BE 0A 13 C3 37 51 63 7C 2E 62 1B 3C 8C 97 3F 9B 4E DB 1D DB A5 02 DE 8F DE B4 51 A5 43>
   AVP: 'Route-Record'(282) l=8 f=-M val="mme.openair4G.eur"
SELECT key,sqn,rand,OPc FROM vhss.users_imsi WHERE imsi='208930000000007';
RijndaelKeySchedule: K FEC86BA6EB707ED08905757B1BB44B8F
sqn_ms_derive() KEY    : fe.c8.6b.a6.eb.70.7e.d0.89.05.75.7b.1b.b4.4b.8f.
sqn_ms_derive() RAND   : 95.be.0a.13.c3.37.51.63.7c.2e.62.1b.3c.8c.97.3f.
sqn_ms_derive() AUTS   : 95.be.0a.13.c3.37.51.63.7c.2e.62.1b.3c.8c.
sqn_ms_derive() AK     : 9b.4e.db.1d.d3.05.
sqn_ms_derive() SQN_MS : 0e.f0.d1.0e.10.32.
sqn_ms_derive() MAC_S  : 51.63.7c.2e.62.1b.3c.8c.
RijndaelKeySchedule: K FEC86BA6EB707ED08905757B1BB44B8F
MAC_S +: 88.8e.6f.11.f8.0a.86.22.
Failed to verify computed SQN_MS
SELECT key,sqn,rand,OPc FROM vhss.users_imsi WHERE imsi='208930000000007';
Generated random
RijndaelKeySchedule: K FEC86BA6EB707ED08905757B1BB44B8F
MAC_A   : 20.8e.72.91.42.70.fd.0a.
SQN     : 00.00.00.00.02.40.
RAND    : e6.48.a9.32.cd.71.f1.22.b2.1c.12.59.2a.e9.98.32.
RijndaelKeySchedule: K FEC86BA6EB707ED08905757B1BB44B8F
AK      : c3.62.34.bc.f4.1b.
CK      : 8b.a1.5f.97.86.7b.a1.3e.78.a3.10.15.24.58.f2.2a.
IK      : c4.6e.d9.5d.b7.2d.1f.28.88.d1.81.46.5e.91.5a.ae.
XRES    : 1d.07.7b.a0.af.80.ed.44.
AUTN    : c3.62.34.bc.f6.5b.80.00.20.8e.72.91.42.70.fd.0a.
0x8b 0xa1 0x5f 0x97 0x86 0x7b 0xa1 0x3e 0x78 0xa3 0x10 0x15 0x24 0x58 0xf2 0x2a 0xc4 0x6e 0xd9 0x5d 0xb7 0x2d 0x1f 0x28 0x88 0xd1 0x81 0x46 0x5e 0x91 0x5a 0xae
0x10 0x02 0xf8 0x39 0x00 0x03 0xc3 0x62 0x34 0xbc 0xf6 0x5b 0x00 0x06
KASME   : 8d.95.29.74.f2.52.15.87.05.a0.bc.5e.89.dd.67.50.f6.86.2b.10.43.4a.a0.39.a7.d4.6e.33.b4.4a.2c.4a.
sqn=00.00.00.00.02.40. eu.u8[]=40.02.00.00.00.00.00.00. eu.u64=576 rand=[e648a932cd71f122b21c12592ae99832]
UPDATE vhss.users_imsi SET rand='e648a932cd71f122b21c12592ae99832', sqn=576 WHERE imsi='208930000000007';
UPDATE vhss.users_imsi SET sqn =608 WHERE imsi='208930000000007';
'Authentication-Information-Answer'
  Version: 0x01
  Length: 20
  Flags: 0x40 (-P--)
  Command Code: 318
  ApplicationId: 16777251
  Hop-by-Hop Identifier: 0x349EBB92
  End-to-End Identifier: 0x00000000
   {internal data}: src:(nil)(0) rwb:(nil) rt:0 cb:(nil),(nil)((nil)) qry:0x7f15a0001f10 asso:0 sess:0x7f15c0000e50
   AVP: 'Session-Id'(263) l=8 f=-M val="mme.openair4G.eur;1625671406;2;apps6a"
   AVP: 'Origin-Host'(264) l=8 f=-M val="hss.openair4G.eur"
   AVP: 'Origin-Realm'(296) l=8 f=-M val="openair4G.eur"
   AVP: 'Auth-Session-State'(277) l=12 f=-M val='NO_STATE_MAINTAINED' (1 (0x1))
   AVP: 'Authentication-Info'(1413) vend='3GPP'(10415) l=12 f=VM val=(grouped)
      AVP: 'E-UTRAN-Vector'(1414) vend='3GPP'(10415) l=12 f=VM val=(grouped)
         AVP: 'RAND'(1447) vend='3GPP'(10415) l=12 f=VM val=<E6 48 A9 32 CD 71 F1 22 B2 1C 12 59 2A E9 98 32>
         AVP: 'XRES'(1448) vend='3GPP'(10415) l=12 f=VM val=<1D 07 7B A0 AF 80 ED 44>
         AVP: 'AUTN'(1449) vend='3GPP'(10415) l=12 f=VM val=<C3 62 34 BC F6 5B 80 00 20 8E 72 91 42 70 FD 0A>
         AVP: 'KASME'(1450) vend='3GPP'(10415) l=12 f=VM val=<8D 95 29 74 F2 52 15 87 05 A0 BC 5E 89 DD 67 50 F6 86 2B 10 43 4A A0 39 A7 D4 6E 33 B4 4A 2C 4A>
   AVP: 'Result-Code'(268) l=12 f=-M val='DIAMETER_SUCCESS' (2001 (0x7d1))
^CREST server on port [9080] shutdown
17:26:49  FATAL! Initiating freeDiameter shutdown sequence (3)
17:26:49  NOTI   freeDiameterd framework is stopping...
17:26:49  NOTI   Shutting down server sockets...
17:26:49  NOTI   Sending terminate signal to all peer connections
17:26:49  NOTI   Waiting for connections shutdown... (16 sec max)
17:26:49  NOTI   'STATE_OPEN'   -> 'STATE_CLOSING_GRACE'        'mme.openair4G.eur'
^C17:27:04  ERROR  mme.openair4G.eur: Going to ZOMBIE state (no more activity)
17:27:04  NOTI   'STATE_CLOSED' -> 'STATE_ZOMBIE' (terminated)  'mme.openair4G.eur'
17:27:04  ERROR  ERROR: in '(pthread_mutex_lock(&p->p_state_mtx))' :    Invalid argument
